parameters:
  arch:     ''
  path:     ''
  prefix:   ''
  owcond:   true

steps:
    - task: ArchiveFiles@2
      displayName: Create Artifact Archive ${{ parameters.prefix }}-${{ parameters.arch }}
      inputs:
        rootFolderOrFile: ${{ parameters.path }}
        includeRootFolder: false
        archiveType: 'tar'
        archiveFile: $(Pipeline.Workspace)/$(owartifactfile)
        replaceExistingArchive: true
      condition: ${{ parameters.owcond }}
    - task: PublishPipelineArtifact@1
      displayName: Save Archive ${{ parameters.prefix }}-${{ parameters.arch }}
      inputs: 
        artifactName: ${{ parameters.prefix }}-${{ parameters.arch }}
        targetPath: $(Pipeline.Workspace)/$(owartifactfile)
      condition: ${{ parameters.owcond }}
    - bash: rm -f $(Pipeline.Workspace)/$(owartifactfile)
      displayName: Remove Archive
      condition: ${{ parameters.owcond }}
