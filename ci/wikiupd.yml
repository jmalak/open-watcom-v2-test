steps:
  - template: gituser.yml
  - checkout: none
  - bash: |
      export SSH_ASKPASS=$(owroot)/ci/askpass.sh
      git clone --depth=1 --branch=master https://$OWGHUSER@github.com/$(owwikiproject).git $(owwikiroot)
    displayName: "Wiki Docs clone"
  - task: DownloadPipelineArtifact@2
    displayName: "Load Artifact wiki-dochtml"
    inputs: 
      buildType:    'current'
      artifactName: wiki-dochtml
      targetPath:   $(owwikiartfpath)
  - task: DownloadPipelineArtifact@2
    displayName: "Load Artifact wiki-docpdf"
    inputs: 
      buildType:    'current'
      artifactName: wiki-docpdf
      targetPath:   $(owwikiartfpath)
  - bash: |
      export SSH_ASKPASS=$(owroot)/ci/askpass.sh
      cd $(owwikiroot)
      git add -v -f .
      if [ -n "$(git status -uno --porcelain)" ]
      then
        git commit -v -m "Azure Pipelines build $(Build.BuildNumber)"
        #git checkout -b temp
        #git checkout master
        #git merge temp
        #git branch -d temp
        git push -v
      fi
      cd $(owroot)
    displayName: "Wiki Docs update"
